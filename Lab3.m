%% Variable definition
L = 12; % [in]
rho = 0.0002505; % [lb-sec^2/in^4]
M_T = 1.131 * rho; % mass of tail
S_T = 0.5655 * rho; % mass moment of tail assembly
I_T = 23.124 * rho; % second mass moment of tail assembly
E = 10175000; % psi
w = 1; % [in]
h = 1/8; % [in]
I_zz = w * h^3 / 12; % [in^4]
A = w * h; % [in^2]
c_K2 = 4*E*I_zz/L^3;
c_M2 = rho*A*L/100800;

%% Matrix Definition [2 element problem]
M2 = c_M2.*[19272 1458*L 5928 -642*L 0 0;...
            1458*L 172*L^2 642*L -73*L^2 0 0;...
            5928 642*L 38544 0 5928 -642*L;...
            -642*L -73*L^2 0 344*L^2 642*L -73*L^2;...
            0 0 5928 642*L 19272+M_T -1458*L+S_T;...
            0 0 -642*L -73*L^2 -1458*L+S_T 172*L^2+I_T];
K2 = c_K2.*[24 6*L -24 6*L 0 0;...
            6*L 2*L^2 -6*L L^2 0 0;...
            -24 -6*L 48 0 -24 6*L;...
            6*L L^2 0 4*L^2 -6*L L^2;...
            0 0 -24 -6*L 24 -6*L;...
            0 0 6*L L^2 -6*L 2*L^2];
% Delete first 2 columns and rows of both matricies (reduced stiffness/mass
% matrix)
M2(1:2,:) = [];
M2(:,1:2) = [];
K2(1:2,:) = [];
K2(:,1:2) = [];

[eigvec2,eigval2] = eig(K2,M2); % solves for eigenvalue/eigenvectors -> eigenvalues net us omega^2
omega_2 = sqrt(diag(eigval2)); % [rad/s]
freq_2 = omega_2(1:3)./(2*pi);

%% Matrix Definition [4 Element Problem]
c_M4 = rho * A * L / 806400;
c_K4 = 8 * E * I_zz / L^3;

M4 = c_M4.*[77088 2916*L 23712 -1284*L 0 0 0 0 0 0;...
        2916*L 172*L^2 1284*L -73*L^2 0 0 0 0 0 0;...
        23712 1284*L 154176 0 23712 -1284*L 0 0 0 0;...
        -1284*L -73*L^2 0 344*L^2 1284*L -73*L^2 0 0 0 0;...
        0 0 23712 1284*L 154176 0 23712 -1284*L 0 0;...
        0 0 -1284*L -73*L^2 0 344*L^2 1284*L -73*L^2 0 0;...
        0 0 0 0 23712 1284*L 154176 0 23712 -1284*L;...
        0 0 0 0 -1284*L -73*L^2 0 344*L^2 1284*L -73*L^2;...
        0 0 0 0 0 0 23712 1284*L 77088+M_T -2916*L+S_T;...
        0 0 0 0 0 0 -1284*L -73*L^2 -2916*L+S_T 172*L^2+I_T];
K4 = c_K4.*[96 12*L -96 12*L 0 0 0 0 0 0;...
        12*L 2*L^2 -12*L L^2 0 0 0 0 0 0;...
        -96 -12*L 192 0 -96 12*L 0 0 0 0;...
        12*L L^2 0 4*L^2 -12*L L^2 0 0 0 0;...
        0 0 -96 -12*L 192 0 -96 12*L 0 0;...
        0 0 12*L L^2 0 4*L^2 -12*L L^2 0 0;...
        0 0 0 0 -96 -12*L 192 0 -96 12*L;...
        0 0 0 0 12*L L^2 0 4*L^2 -12*L L^2;...
        0 0 0 0 0 0 -96 -12*L 96 -12*L;...
        0 0 0 0 0 0 12*L L^2 -12*L 2*L^2];
% Delete first 2 columns and rows of both matricies (reduced stiffness/mass
% matrix)
M4(1:2,:) = [];
M4(:,1:2) = [];
K4(1:2,:) = [];
K4(:,1:2) = [];

[eigvec4,eigval4] = eig(K4,M4); % solves for eigenvalue/eigenvectors -> eigenvalues net us omega^2
omega_4 = sqrt(diag(eigval4)) % [rad/s]
freq_4 = omega_4(1:3)./(2*pi)